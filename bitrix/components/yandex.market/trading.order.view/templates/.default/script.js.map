{"version":3,"file":"script.js","sources":["src/order.js","src/box.js","src/boxcollection.js","src/basketitemskeletonmodal.js","src/basketitemmovemodal.js","src/basketitemsplitmodal.js","src/basketitem.js","src/basket.js","src/basketitemcis.js","src/basketitemcissummary.js","src/basketitemdigital.js","src/basketitemdigitalsummary.js","src/basketconfirmform.js","src/basketconfirmsummary.js","src/shipmentprint.js","src/shipmentsubmit.js"],"sourcesContent":["const BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst FieldReference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = FieldReference.Complex.extend({\r\n\r\n\tdefaults: {\r\n\t\tchildElement: '.js-yamarket-order__field',\r\n\t\tinputElement: '.js-yamarket-order__input',\r\n\t\tareaElement: '.js-yamarket-order__area',\r\n\t\trefreshUrl: null,\r\n\t},\r\n\r\n\tinitialize: function() {\r\n\t\tthis.callParent('initialize', constructor);\r\n\t\tthis.bind();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('destroy', constructor);\r\n\t},\r\n\r\n\tbind: function() {\r\n\t\tthis.handleActivityEnd(true);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleActivityEnd(false);\r\n\t},\r\n\r\n\thandleActivityEnd: function(dir) {\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent'](this.el, 'yamarketActivitySubmitEnd', BX.proxy(this.onActivityEnd, this));\r\n\t},\r\n\r\n\tonActivityEnd: function() {\r\n\t\tthis.refresh();\r\n\t},\r\n\r\n\tgetId: function() {\r\n\t\tconst input = this.getInput('ID');\r\n\r\n\t\treturn input && input.val();\r\n\t},\r\n\r\n\tconfirm: function() {\r\n\t\tconst boxCollection = this.getChildField('BOX');\r\n\t\tconst basketConfirm = this.getChildField('BASKET_CONFIRM');\r\n\r\n\t\tif (!boxCollection || !basketConfirm) { return; }\r\n\r\n\t\treturn basketConfirm.confirm(boxCollection);\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tthis.callChildList('validate');\r\n\t},\r\n\r\n\tcommit: function() {\r\n\t\tconst boxCollection = this.getChildField('BOX');\r\n\t\tlet hasChanges = false;\r\n\t\tlet boxIndex = 0;\r\n\r\n\t\tif (boxCollection == null) { return; }\r\n\r\n\t\tboxCollection.callItemList(function(box) {\r\n\t\t\tif (box.getBasket().commit(boxIndex)) {\r\n\t\t\t\thasChanges = true;\r\n\t\t\t}\r\n\r\n\t\t\t++boxIndex;\r\n\t\t});\r\n\r\n\t\thasChanges && this.refresh();\r\n\t},\r\n\r\n\trefresh: function() {\r\n\t\t$.ajax({ url: this.options.refreshUrl })\r\n\t\t\t.then($.proxy(this.updateArea, this))\r\n\t\t\t.then($.proxy(this.hideLoading, this));\r\n\t},\r\n\r\n\tupdateArea: function(html) {\r\n\t\tconst contents = $(html);\r\n\t\tconst newAreas = this.getElement('area', contents);\r\n\t\tconst newMap = this.mapAreas(newAreas);\r\n\t\tconst existsAreas = this.getElement('area');\r\n\t\tconst existsMap = this.mapAreas(existsAreas);\r\n\r\n\t\tfor (const type in newMap) {\r\n\t\t\tif (!newMap.hasOwnProperty(type)) { continue; }\r\n\t\t\tif (!existsMap.hasOwnProperty(type)) { continue; }\r\n\r\n\t\t\tconst newArea = newMap[type];\r\n\t\t\tconst existsArea = existsMap[type];\r\n\r\n\t\t\texistsArea.replaceWith(newArea);\r\n\r\n\t\t\tBX.onCustomEvent(newArea[0], 'onYaMarketContentUpdate', [\r\n\t\t\t\t{ target: newArea[0] }\r\n\t\t\t]);\r\n\t\t}\r\n\t},\r\n\r\n\tmapAreas: function(areas) {\r\n\t\tconst result = {};\r\n\r\n\t\tfor (let index = 0; index < areas.length; ++index) {\r\n\t\t\tconst area = areas.eq(index);\r\n\t\t\tconst type = area.data('type');\r\n\r\n\t\t\tif (!type) { continue; }\r\n\r\n\t\t\tresult[type] = area;\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\thideLoading: function() {\r\n\t\tBX.closeWait(this.el);\r\n\t}\r\n\r\n\r\n}, {\r\n\tdataName: 'orderViewOrder',\r\n\tpluginName: 'YandexMarket.OrderView.Order',\r\n});\r\n\r\nexport const Order = constructor;","const BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst Reference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = Reference.Complex.extend({\r\n\r\n\tdefaults: {\r\n\t\tselfElement: '.js-yamarket-box',\r\n\t\ttitleElement: '.js-yamarket-box__title',\r\n\t\tnumberElement: '.js-yamarket-box__number',\r\n\t\tinputElement: '.js-yamarket-box__input',\r\n\t\tchildElement: '.js-yamarket-box__child',\r\n\t\tdeleteElement: '.js-yamarket-box__delete',\r\n\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BOX_',\r\n\t\tlang: {},\r\n\t},\r\n\r\n\tinitialize: function() {\r\n\t\tthis.callParent('initialize', constructor);\r\n\t\tthis.bind();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('destroy', constructor);\r\n\t},\r\n\r\n\tbind: function() {\r\n\t\tthis.handleDeleteClick(true);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleDeleteClick(false);\r\n\t},\r\n\r\n\thandleDeleteClick: function(dir) {\r\n\t\tconst deleteButton = this.getElement('delete');\r\n\r\n\t\tdeleteButton[dir ? 'on' : 'off']('click', $.proxy(this.onDeleteClick, this));\r\n\t},\r\n\r\n\tonDeleteClick: function(evt) {\r\n\t\tevt.preventDefault();\r\n\r\n\t\tif (this.onlyForPart()) {\r\n\t\t\tif (!confirm(this.getLang('DELETE_PART_BY_MERGE'))) { return; }\r\n\r\n\t\t\tthis.getBasket().callItemList('cancelSplit');\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.getCollection().deleteItem(this.$el);\r\n\t},\r\n\r\n\tonlyForPart: function() {\r\n\t\tlet result = false;\r\n\r\n\t\tthis.getBasket().callItemList(function(basketItem) {\r\n\t\t\tif (basketItem.isPart()) {\r\n\t\t\t\tresult = true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tthis.callChildList('validate');\r\n\t},\r\n\r\n\tgetTitle: function() {\r\n\t\tconst title = this.getElement('title');\r\n\r\n\t\treturn title && title.text().replace(/\\s+/g, ' ').trim();\r\n\t},\r\n\r\n\tsetIndex: function(index) {\r\n\t\tthis.callParent('setIndex', [index], constructor);\r\n\t\tthis.updateNumber(index);\r\n\t},\r\n\r\n\trefreshDelete: function(enabled) {\r\n\t\tthis.getElement('delete').prop('disabled', !enabled);\r\n\t},\r\n\r\n\trefreshNumber: function() {\r\n\t\tconst index = this.getIndex();\r\n\t\tthis.updateNumber(index);\r\n\t},\r\n\r\n\tupdateNumber: function(index) {\r\n\t\tthis.getElement('number').html('&numero;' + (index + 1));\r\n\t},\r\n\r\n\tgetBasket: function() {\r\n\t\treturn this.getChildField('ITEMS');\r\n\t},\r\n\r\n\tgetCollection: function() {\r\n\t\treturn this.getParentField();\r\n\t},\r\n\r\n\tgetElement: function(key, context, method) {\r\n\t\tif (key === 'child') {\r\n\t\t\tconst keySelector = this.getElementSelector(key);\r\n\t\t\tconst selfSelector = this.getElementSelector('self');\r\n\r\n\t\t\treturn (context || this.$el).nextUntil(selfSelector, keySelector);\r\n\t\t}\r\n\r\n\t\treturn this.callParent('getElement', [key, context, method], constructor);\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBox',\r\n\tpluginName: 'YandexMarket.OrderView.Box',\r\n});\r\n\r\nexport const Box = constructor;","import {Box} from \"./box\";\r\n\r\nconst BX = window.BX;\r\nconst Reference = BX.namespace('YandexMarket.Field.Reference');\r\nconst Plugin = BX.namespace('YandexMarket.Plugin');\r\n\r\nconst constructor = Reference.Collection.extend({\r\n\r\n\tdefaults: {\r\n\t\titemElement: '.js-yamarket-box',\r\n\t\tfooterElement: 'tfoot',\r\n\t},\r\n\r\n\tgetCountChanges: function() {\r\n\t\tlet result = [];\r\n\r\n\t\tthis.callItemList(function(box) {\r\n\t\t\tresult = result.concat(box.getBasket().getCountChanges());\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetPreviousMovableBox: function(box) {\r\n\t\tlet previous;\r\n\t\tlet result;\r\n\r\n\t\tthis.callItemList(function(item) {\r\n\t\t\tif (item === box) {\r\n\t\t\t\tresult = previous;\r\n\t\t\t}\r\n\r\n\t\t\tif (!item.onlyForPart()) {\r\n\t\t\t\tprevious = item;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetNextMovableBox: function(box) {\r\n\t\tlet found = false;\r\n\t\tlet result;\r\n\r\n\t\tthis.callItemList(function(item) {\r\n\t\t\tif (found && result == null && !item.onlyForPart()) {\r\n\t\t\t\tresult = item;\r\n\t\t\t}\r\n\r\n\t\t\tif (item === box) {\r\n\t\t\t\tfound = true;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tcreateNew: function() {\r\n\t\treturn this.addItem();\r\n\t},\r\n\r\n\tsameBasketItems: function(basketItem) {\r\n\t\tlet result = [];\r\n\r\n\t\tthis.callItemList(function(box) {\r\n\t\t\tresult = result.concat(box.getBasket().sameBasketItems(basketItem));\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tthis.callItemList(function(box) {\r\n\t\t\ttry {\r\n\t\t\t\tbox.validate()\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconst title = box.getTitle();\r\n\t\t\t\tconst message = (title ? title + ': ' : '') + e.message;\r\n\r\n\t\t\t\tthrow new Error(message);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\taddItem: function(source, context, method, isCopy) {\r\n\t\tconst result = this.callParent('addItem', [source, context, method, isCopy], constructor);\r\n\r\n\t\tthis.refreshBoxNumber();\r\n\t\tthis.refreshBoxDelete();\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tdetachItem: function(item) {\r\n\t\tconst itemSelector = this.getElementSelector('item');\r\n\t\tconst footerSelector = this.getElementSelector('footer');\r\n\t\tconst siblings = item.nextUntil([itemSelector, footerSelector].join(', '));\r\n\r\n\t\tthis.callParent('detachItem', [item.add(siblings)], constructor);\r\n\t},\r\n\r\n\tcloneItem: function(sourceItem) {\r\n\t\tconst itemSelector = this.getElementSelector('item');\r\n\t\tconst footerSelector = this.getElementSelector('footer');\r\n\t\tconst siblings = sourceItem.nextUntil([itemSelector, footerSelector].join(', '));\r\n\r\n\t\treturn sourceItem.clone(false, false).add(siblings.clone(false, false));\r\n\t},\r\n\r\n\tappendItem: function(item, context, method) {\r\n\t\tif (method === 'after') {\r\n\t\t\tconst itemSelector = this.getElementSelector('item');\r\n\t\t\tconst footerSelector = this.getElementSelector('footer');\r\n\t\t\tconst next = context.nextAll([itemSelector, footerSelector].join(', '));\r\n\r\n\t\t\tif (next.length > 0) {\r\n\t\t\t\tcontext = next.eq(0);\r\n\t\t\t\tmethod = 'before';\r\n\t\t\t} else {\r\n\t\t\t\tcontext = context.parent();\r\n\t\t\t\tmethod = 'append';\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tcontext[method](item);\r\n\t\tPlugin.manager.initializeContext(item);\r\n\t},\r\n\r\n\tdeleteItem: function(item, silent) {\r\n\t\tthis.transferBasket(item);\r\n\t\tthis.callParent('deleteItem', [item, silent], constructor);\r\n\t\tthis.refreshBoxNumber();\r\n\t\tthis.refreshBoxDelete();\r\n\t},\r\n\r\n\ttransferBasket: function(item) {\r\n\t\tconst box = this.getItemInstance(item);\r\n\t\tconst basket = box.getBasket();\r\n\r\n\t\tif (basket.getActiveItems().length === 0) { return; }\r\n\r\n\t\tconst siblingBox = this.getPreviousMovableBox(box) ?? this.getNextMovableBox(box);\r\n\r\n\t\tif (siblingBox == null) { throw new Error('cant delete last box'); }\r\n\r\n\t\tbasket.callItemList('move', [siblingBox]);\r\n\t},\r\n\r\n\tinitializeItem: function(item, index, sourceItem) {\r\n\t\treturn this.callParent('initializeItem', [item.eq(0), index, sourceItem], constructor);\r\n\t},\r\n\r\n\trefreshBoxNumber: function() {\r\n\t\tthis.callItemList('refreshNumber');\r\n\t},\r\n\r\n\trefreshBoxDelete: function() {\r\n\t\tconst enabled = this.getActiveItems().length > 1;\r\n\r\n\t\tthis.callItemList('refreshDelete', [enabled]);\r\n\t},\r\n\r\n\tgetOrder: function() {\r\n\t\treturn this.getParentField();\r\n\t},\r\n\r\n\tgetItemPlugin: function() {\r\n\t\treturn Box;\r\n\t}\r\n\r\n}, {\r\n\tdataName: 'orderViewBoxCollection',\r\n\tpluginName: 'YandexMarket.OrderView.BoxCollection',\r\n});\r\n\r\nexport const BoxCollection = constructor;","const BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst YandexMarket = BX.namespace('YandexMarket');\r\nconst Plugin = BX.namespace('YandexMarket.Plugin');\r\n\r\nconst constructor = Plugin.Base.extend({\r\n\r\n\tdefaults: {\r\n\t\tmodalWidth: 400,\r\n\t\tmodalHeight: 150,\r\n\r\n\t\tlang: {},\r\n\t},\r\n\r\n\tinitVars: function() {\r\n\t\tthis.callParent('initVars', constructor);\r\n\t\tthis._modal = null;\r\n\t\tthis._openDeferred = null;\r\n\t},\r\n\r\n\thandleModal: function(modal, dir) {\r\n\t\tthis.handleModalSave(modal, dir);\r\n\t\tthis.handleModalClose(modal, dir);\r\n\t},\r\n\r\n\thandleModalSave: function(modal, dir) {\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent'](modal, 'onWindowSave', BX.proxy(this.onModalSave, this));\r\n\t},\r\n\r\n\thandleModalClose: function(modal, dir) {\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent'](modal, 'onWindowClose', BX.proxy(this.onModalClose, this));\r\n\t},\r\n\r\n\tonModalSave: function() {\r\n\t\tconst modal = this.modal();\r\n\r\n\t\tthis.resolve(modal);\r\n\t\tthis.handleModal(modal, false);\r\n\t\tthis.destroyModal(modal);\r\n\t\tmodal.Close();\r\n\t},\r\n\r\n\tonModalClose: function() {\r\n\t\tconst modal = this.modal(true);\r\n\r\n\t\tif (modal == null) { return; }\r\n\r\n\t\tthis.reject();\r\n\t\tthis.handleModal(modal, false);\r\n\t\tthis.destroyModal(modal);\r\n\t},\r\n\r\n\topen: function() {\r\n\t\tconst modal = this.modal();\r\n\r\n\t\tmodal.SetContent(this.$el.html());\r\n\t\tmodal.Show();\r\n\r\n\t\tthis.afterOpen(modal);\r\n\t\tthis.handleModal(modal, true);\r\n\r\n\t\treturn (this._openDeferred = new $.Deferred());\r\n\t},\r\n\r\n\tafterOpen: function(modal) {},\r\n\r\n\tresolve: function(modal) {\r\n\t\tif (this._openDeferred == null) { return; }\r\n\r\n\t\tthis._openDeferred.resolve(this.resolveValues(modal));\r\n\t\tthis._openDeferred = null;\r\n\t},\r\n\r\n\treject: function() {\r\n\t\tif (this._openDeferred == null) { return; }\r\n\r\n\t\tthis._openDeferred.reject();\r\n\t\tthis._openDeferred = null;\r\n\t},\r\n\r\n\tresolveValues: function(modal) {\r\n\t\treturn null;\r\n\t},\r\n\r\n\tmodal: function(skipCreate) {\r\n\t\tif (this._modal == null && !skipCreate) {\r\n\t\t\tthis._modal = new YandexMarket.EditDialog({\r\n\t\t\t\t'title': this.getLang('TITLE'),\r\n\t\t\t\t'draggable': true,\r\n\t\t\t\t'resizable': true,\r\n\t\t\t\t'buttons': [YandexMarket.EditDialog.btnSave, YandexMarket.EditDialog.btnCancel],\r\n\t\t\t\t'width': this.options.modalWidth,\r\n\t\t\t\t'height': this.options.modalHeight,\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn this._modal;\r\n\t},\r\n\r\n\tmodalContent: function(modal) {\r\n\t\treturn $(modal.PARTS.CONTENT_DATA);\r\n\t},\r\n\r\n\tdestroyModal: function() {\r\n\t\tthis._modal = null;\r\n\t},\r\n\r\n});\r\n\r\nexport const BasketItemSkeletonModal = constructor;","import {BasketItemSkeletonModal} from \"./basketitemskeletonmodal\";\r\n\r\nconst $ = window.jQuery;\r\n\r\nconst constructor = BasketItemSkeletonModal.extend({\r\n\r\n\tdefaults: {\r\n\t\tcount: 1,\r\n\t\tcountElement: 'input[name=\"MOVE_COUNT\"]',\r\n\t\tboxElement: 'select[name=\"MOVE_BOX\"]',\r\n\r\n\t\tboxCollection: null,\r\n\t\tcurrentIndex: null,\r\n\t\tselectedIndex: null,\r\n\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_ITEM_MOVE_',\r\n\t\tlang: {},\r\n\t},\r\n\r\n\tafterOpen: function(modal) {\r\n\t\tconst content = this.modalContent(modal);\r\n\r\n\t\tthis.renderCount(content);\r\n\t\tthis.renderBox(content);\r\n\t},\r\n\r\n\trenderCount: function(content) {\r\n\t\tconst input = this.getElement('count', content);\r\n\r\n\t\tinput.val(this.options.count);\r\n\t\tinput.prop('max', this.options.count);\r\n\t},\r\n\r\n\trenderBox: function(content) {\r\n\t\tconst select = this.getElement('box', content);\r\n\t\tconst boxes = this.options.boxCollection.getItemInstances();\r\n\r\n\t\tfor (let i = 0; i < boxes.length; i++) {\r\n\t\t\tconst box = boxes[i];\r\n\t\t\tconst boxIndex = box.getIndex() || 0;\r\n\r\n\t\t\tif (boxIndex === this.options.currentIndex || box.onlyForPart()) { continue; }\r\n\r\n\t\t\tconst option = $(`<option value=\"${boxIndex + 1}\">${box.getTitle()}</option>`);\r\n\r\n\t\t\toption.prependTo(select);\r\n\t\t\toption.prop('selected', boxIndex === this.options.selectedIndex);\r\n\t\t}\r\n\r\n\t\tif (this.options.selectedIndex == null) {\r\n\t\t\tselect.find('option').eq(-1).prop('selected', true);\r\n\t\t}\r\n\t},\r\n\r\n\tresolveValues: function(modal) {\r\n\t\tconst content = this.modalContent(modal);\r\n\r\n\t\treturn [\r\n\t\t\tthis.resolvedBox(content),\r\n\t\t\tthis.resolvedCount(content),\r\n\t\t];\r\n\t},\r\n\r\n\tresolvedBox: function(content) {\r\n\t\tconst select = this.getElement('box', content);\r\n\t\tconst selected = parseInt(select.val()) || 0;\r\n\r\n\t\tif (selected === 0) { return this.options.boxCollection.createNew(); }\r\n\r\n\t\tconst boxElement = this.options.boxCollection.getItem(selected - 1);\r\n\r\n\t\tif (boxElement == null) { throw new Error(`cant find box with index ${selected}`); }\r\n\r\n\t\treturn this.options.boxCollection.getItemInstance(boxElement);\r\n\t},\r\n\r\n\tresolvedCount: function(content) {\r\n\t\tconst input = this.getElement('count', content);\r\n\r\n\t\treturn parseInt(input.val()) || 1;\r\n\t},\r\n\r\n});\r\n\r\nexport const BasketItemMoveModal = constructor;","import {BasketItemSkeletonModal} from \"./basketitemskeletonmodal\";\r\n\r\nconst constructor = BasketItemSkeletonModal.extend({\r\n\r\n\tdefaults: {\r\n\t\tcountElement: 'input[name=\"SPLIT_COUNT\"]',\r\n\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_ITEM_SPLIT_',\r\n\t\tlang: {},\r\n\t},\r\n\r\n\tresolveValues: function(modal) {\r\n\t\tconst input = this.getElement('count', this.modalContent(modal));\r\n\r\n\t\treturn parseInt(input.val().trim()) || 1;\r\n\t},\r\n\r\n});\r\n\r\nexport const BasketItemSplitModal = constructor;","import { BasketItemMoveModal } from \"./basketitemmovemodal\";\r\nimport { BasketItemSplitModal } from \"./basketitemsplitmodal\";\r\n\r\nconst BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst FieldReference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = FieldReference.Complex.extend({\r\n\r\n\tdefaults: {\r\n\t\tid: null,\r\n\r\n\t\tchildElement: '.js-yamarket-basket-item__field',\r\n\t\tinputElement: '.js-yamarket-basket-item__data',\r\n\r\n\t\tupElement: '.js-yamarket-basket-item__up',\r\n\t\tmoreElement: '.js-yamarket-basket-item__more',\r\n\t\tdownElement: '.js-yamarket-basket-item__down',\r\n\t\tsplitElement: '.js-yamarket-basket-item__split',\r\n\t\tsplitModalElement: '#yamarket-basket-split-modal',\r\n\t\tmoveModalElement: '#yamarket-basket-move-modal',\r\n\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_ITEM_',\r\n\t\tlang: {},\r\n\t},\r\n\r\n\tinitVars: function() {\r\n\t\tthis.callParent('initVars', constructor);\r\n\t\tthis._moreDropdown = null;\r\n\t},\r\n\r\n\tinitialize: function() {\r\n\t\tthis.callParent('initialize', constructor);\r\n\t\tthis.bind();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('destroy', constructor);\r\n\t},\r\n\r\n\tbind: function() {\r\n\t\tthis.handleCountChange(true);\r\n\t\tthis.handleUp(true);\r\n\t\tthis.handleDown(true);\r\n\t\tthis.handleMore(true);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleCountChange(false);\r\n\t\tthis.handleUp(false);\r\n\t\tthis.handleDown(false);\r\n\t\tthis.handleMore(false);\r\n\t},\r\n\r\n\thandleCountChange: function(dir) {\r\n\t\tconst input = this.getInput('COUNT');\r\n\r\n\t\tif (!input) { return; }\r\n\r\n\t\tinput[dir ? 'on' : 'off']('change',  $.proxy(this.onCountChange, this));\r\n\t},\r\n\r\n\thandleUp: function(dir) {\r\n\t\tthis.getElement('up')[dir ? 'on' : 'off']('click',  $.proxy(this.onUp, this));\r\n\t},\r\n\r\n\thandleDown: function(dir) {\r\n\t\tthis.getElement('down')[dir ? 'on' : 'off']('click',  $.proxy(this.onDown, this));\r\n\t},\r\n\r\n\thandleMore: function(dir) {\r\n\t\tthis.getElement('more')[dir ? 'on' : 'off']('click',  $.proxy(this.onMore, this));\r\n\t},\r\n\r\n\tonCountChange: function() {\r\n\t\tthis.updateCisCount();\r\n\t},\r\n\r\n\tonUp: function() {\r\n\t\tconst box = this.getBasket().getBox();\r\n\t\tconst boxCollection = box.getCollection();\r\n\r\n\t\tthis.moveStart(boxCollection, box, boxCollection.getPreviousMovableBox(box));\r\n\t},\r\n\r\n\tonDown: function() {\r\n\t\tconst box = this.getBasket().getBox();\r\n\t\tconst boxCollection = box.getCollection();\r\n\r\n\t\tthis.moveStart(boxCollection, box, boxCollection.getNextMovableBox(box));\r\n\t},\r\n\r\n\tonMore: function(evt) {\r\n\t\tconst menu = this.moreDropdown(evt.currentTarget);\r\n\r\n\t\tmenu.setItems(this.moreMenuItems());\r\n\t\tmenu.Show();\r\n\t},\r\n\r\n\tid: function() {\r\n\t\treturn this.getInput('ID').val();\r\n\t},\r\n\r\n\tmoveStart: function(boxCollection, currentBox, selectedBox) {\r\n\t\tconst count = this.getCount();\r\n\r\n\t\tif (count <= 1) {\r\n\t\t\tconst newItem = this.move(selectedBox ?? boxCollection.createNew());\r\n\r\n\t\t\tnewItem.recalculateOffset();\r\n\t\t\tnewItem.getBasket().refreshItemMove();\r\n\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t(new BasketItemMoveModal(this.getElement('moveModal'), {\r\n\t\t\tcount: count,\r\n\t\t\tcurrentIndex: currentBox.getIndex(),\r\n\t\t\tselectedIndex: selectedBox != null ? selectedBox.getIndex() : null,\r\n\t\t\tboxCollection: boxCollection,\r\n\t\t}))\r\n\t\t\t.open()\r\n\t\t\t.then((resolved) => {\r\n\t\t\t\tconst [box, moveCount] = resolved;\r\n\t\t\t\tlet newItem;\r\n\r\n\t\t\t\tif (moveCount < count) {\r\n\t\t\t\t\tnewItem = this.move(box, moveCount, true);\r\n\r\n\t\t\t\t\tthis.setCount(this.getCount() - moveCount);\r\n\t\t\t\t\tthis.setInitialCount(this.getInitialCount() - moveCount);\r\n\t\t\t\t\tthis.recalculateOffset();\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnewItem = this.move(box);\r\n\t\t\t\t\tnewItem.recalculateOffset();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tnewItem.getBasket().refreshItemMove();\r\n\t\t\t});\r\n\t},\r\n\r\n\tmove: function(newBox, count, needClone) {\r\n\t\tconst newBasket = newBox.getBasket();\r\n\t\tconst sameItems = newBasket.sameBasketItems(this);\r\n\t\tconst basket = this.getBasket();\r\n\t\tconst box = basket.getBox();\r\n\t\tlet newItem;\r\n\r\n\t\tif (sameItems.length > 0) {\r\n\t\t\tnewItem = sameItems[0];\r\n\r\n\t\t\tif (count == null) { count = this.getCount(); }\r\n\r\n\t\t\tnewItem.setCount(newItem.getCount() + count);\r\n\t\t\tnewItem.setInitialCount(newItem.getInitialCount() + count);\r\n\r\n\t\t\t!needClone && basket.deleteItem(this.$el);\r\n\t\t} else {\r\n\t\t\tnewItem = newBox.getBasket().insertItem(needClone ? this.$el.clone(false, false) : this.$el);\r\n\r\n\t\t\tif (count != null) {\r\n\t\t\t\tnewItem.setCount(count);\r\n\t\t\t\tnewItem.setInitialCount(count);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (basket.getActiveItems().length === 0) {\r\n\t\t\tbox.getCollection().deleteItem(box.$el);\r\n\t\t} else {\r\n\t\t\tbasket.refreshItemMove();\r\n\t\t}\r\n\r\n\t\treturn newItem;\r\n\t},\r\n\r\n\tmoreDropdown: function(anchor) {\r\n\t\tif (this._moreDropdown == null) {\r\n\t\t\tthis._moreDropdown = new BX.CMenu({\r\n\t\t\t\tATTACH_MODE: 'bottom',\r\n\t\t\t\tSET_ID: 'bx-admin-prefix',\r\n\t\t\t\tCLOSE_ON_CLICK: true,\r\n\t\t\t\tparent: anchor,\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn this._moreDropdown;\r\n\t},\r\n\r\n\tmoreMenuItems: function() {\r\n\t\tconst values = this.getValue();\r\n\r\n\t\treturn (\r\n\t\t\tthis.moreMenuItemsForSplit(values)\r\n\t\t\t\t.concat(this.moreMenuItemsForDelete(values))\r\n\t\t);\r\n\t},\r\n\r\n\tmoreMenuItemsForDelete: function(values) {\r\n\t\tif (values['DELETE'] == null || values['PARTIAL_CURRENT']) { return []; }\r\n\r\n\t\tconst result = [];\r\n\r\n\t\tif (values['DELETE']) {\r\n\t\t\tresult.push({\r\n\t\t\t\tONCLICK: $.proxy(this.markDeleted, this, false),\r\n\t\t\t\tTEXT: this.getLang('CANCEL_DELETE'),\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tresult.push({\r\n\t\t\t\tONCLICK: $.proxy(this.markDeleted, this, true),\r\n\t\t\t\tTEXT: this.getLang('DELETE'),\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tmoreMenuItemsForSplit: function(values) {\r\n\t\tif (values['PARTIAL_CURRENT'] == null || values['DELETE']) { return []; }\r\n\r\n\t\tconst result = [];\r\n\r\n\t\tif (values['PARTIAL_CURRENT']) {\r\n\t\t\tresult.push({\r\n\t\t\t\tONCLICK: $.proxy(this.cancelSplit, this),\r\n\t\t\t\tTEXT: this.getLang('CANCEL_SPLIT'),\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tresult.push({\r\n\t\t\t\tONCLICK: $.proxy(this.splitStart, this),\r\n\t\t\t\tTEXT: this.getLang('SPLIT'),\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tmarkDeleted: function(deleted) {\r\n\t\tthis.getInput('DELETE').val(deleted ? 'Y' : '');\r\n\t\tthis.$el.toggleClass('is--deleted', !!deleted);\r\n\t},\r\n\r\n\tcancelSplit: function() {\r\n\t\tconst parts = this.getBasket().getBox().getCollection().sameBasketItems(this);\r\n\t\tconst [count, initialCount] = this.countSiblings(parts);\r\n\t\tlet first = true;\r\n\r\n\t\tfor (const part of parts) {\r\n\t\t\tif (first) {\r\n\t\t\t\tconst basket = part.getBasket();\r\n\t\t\t\tconst box = basket.getBox();\r\n\t\t\t\tconst previousBox = box.getCollection().getPreviousMovableBox(box) ?? box.getCollection().getNextMovableBox(box);\r\n\r\n\t\t\t\tpart.resetPart();\r\n\t\t\t\tpart.setCount(count);\r\n\t\t\t\tpart.setInitialCount(initialCount);\r\n\t\t\t\tpart.setOffset(0);\r\n\t\t\t\tpart.updateCisCount();\r\n\r\n\t\t\t\tif (previousBox != null) {\r\n\t\t\t\t\tpart.move(previousBox);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpart.getBasket().refreshItemMove();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfirst = false;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\r\n\t\t\tconst basket = part.getBasket();\r\n\t\t\tconst box = basket.getBox();\r\n\r\n\t\t\tbasket.deleteItem(part.$el);\r\n\r\n\t\t\tif (basket.getActiveItems().length === 0) {\r\n\t\t\t\tbox.getCollection().deleteItem(box.$el);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tcountSiblings: function(basketItems) {\r\n\t\tlet count = 0;\r\n\t\tlet initialCount = 0;\r\n\r\n\t\tfor (const basketItem of basketItems) {\r\n\t\t\tif (!basketItem.isPart() || basketItem.isFinalPart()) {\r\n\t\t\t\tcount += basketItem.getCount() || 0;\r\n\t\t\t\tinitialCount += basketItem.getInitialCount() || 0;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn [count, initialCount];\r\n\t},\r\n\r\n\tsplitStart: function() {\r\n\t\t(new BasketItemSplitModal(this.getElement('splitModal')))\r\n\t\t\t.open()\r\n\t\t\t.then((total) => this.split(total));\r\n\t},\r\n\r\n\tsplit: function(total) {\r\n\t\tconst basket = this.getBasket();\r\n\t\tconst boxCollection = basket.getBox().getCollection();\r\n\t\tconst [deletedCount, deletedInitialCount] = this.removeSiblings();\r\n\t\tconst count = (this.getCount() || 1) + deletedCount;\r\n\t\tconst initialCount = (this.getInitialCount() || 1) + deletedInitialCount;\r\n\t\tlet lastItem;\r\n\r\n\t\tfor (let productIndex = 0; productIndex < count; ++productIndex) {\r\n\t\t\tfor (let i = 0; i < total; ++i) {\r\n\t\t\t\tconst isSelf = (productIndex === 0 && i === 0);\r\n\t\t\t\tconst newItem = this.move(boxCollection.createNew(), 1, !isSelf);\r\n\r\n\t\t\t\tnewItem.setPart(i, total);\r\n\r\n\t\t\t\tif (productIndex === 0) {\r\n\t\t\t\t\tnewItem.setInitialCount(1 + (initialCount - count));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlastItem = newItem;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlastItem?.recalculateOffset();\r\n\t},\r\n\r\n\tremoveSiblings() {\r\n\t\tconst sameItems = this.getBasket().getBox().getCollection().sameBasketItems(this);\r\n\t\tlet deletedCount = 0;\r\n\t\tlet deletedInitialCount = 0;\r\n\r\n\t\tfor (const sameItem of sameItems) {\r\n\t\t\tif (sameItem === this) { continue; }\r\n\r\n\t\t\tconst basket = sameItem.getBasket();\r\n\r\n\t\t\tdeletedCount += sameItem.getCount() || 0;\r\n\t\t\tdeletedInitialCount += sameItem.getInitialCount() || 0;\r\n\r\n\t\t\tbasket.deleteItem(sameItem.$el);\r\n\r\n\t\t\tif (basket.getActiveItems().length === 0) {\r\n\t\t\t\tconst box = basket.getBox();\r\n\t\t\t\tbox.getCollection().deleteItem(box.$el);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn [deletedCount, deletedInitialCount];\r\n\t},\r\n\r\n\tresetPart: function() {\r\n\t\tconst currentInput = this.getInput('PARTIAL_CURRENT');\r\n\t\tconst totalInput = this.getInput('PARTIAL_TOTAL');\r\n\t\tconst nameElement = this.getInput('PARTIAL_NAME');\r\n\r\n\t\tthis.$el.removeClass('is--partial');\r\n\t\tcurrentInput.val('');\r\n\t\ttotalInput.val('');\r\n\t\tnameElement.text('');\r\n\t},\r\n\r\n\tsetPart: function(index, total) {\r\n\t\tconst currentInput = this.getInput('PARTIAL_CURRENT');\r\n\t\tconst totalInput = this.getInput('PARTIAL_TOTAL');\r\n\t\tconst nameElement = this.getInput('PARTIAL_NAME');\r\n\r\n\t\tthis.$el.addClass('is--partial');\r\n\t\tcurrentInput.val(index + 1);\r\n\t\ttotalInput.val(total);\r\n\t\tnameElement.text(`${this.getLang('PART')} ${index + 1}/${total}`);\r\n\t},\r\n\r\n\trefreshMoveUp: function(canMoveUp) {\r\n\t\tthis.getElement('up').prop('disabled', !canMoveUp || this.isPart());\r\n\t},\r\n\r\n\trefreshMoveDown: function(canMoveDown) {\r\n\t\tif (!canMoveDown && this.getCount() > 1) {\r\n\t\t\tcanMoveDown = true;\r\n\t\t}\r\n\r\n\t\tthis.getElement('down').prop('disabled', !canMoveDown || this.isPart());\r\n\t},\r\n\r\n\tupdateCisCount: function() {\r\n\t\tconst count = this.getCount();\r\n\t\tconst offset = this.getOffset();\r\n\t\tconst isValid = (count > 0);\r\n\t\tconst fields = [\r\n\t\t\tthis.getCis(),\r\n\t\t\tthis.getDigital(),\r\n\t\t];\r\n\r\n\t\tif (!isValid) { return; }\r\n\r\n\t\tfor (const field of fields) {\r\n\t\t\tif (field == null) { continue; }\r\n\r\n\t\t\tfield.setBasketCount(count, offset);\r\n\t\t\tfield.refreshSummary();\r\n\t\t}\r\n\t},\r\n\r\n\tisPart: function() {\r\n\t\tconst input = this.getInput('PARTIAL_CURRENT');\r\n\r\n\t\treturn input && !!(input.val());\r\n\t},\r\n\r\n\tisFinalPart: function() {\r\n\t\tconst currentInput = this.getInput('PARTIAL_CURRENT');\r\n\t\tconst currentValue = currentInput && parseInt(currentInput.val()) || 0;\r\n\t\tconst totalInput = this.getInput('PARTIAL_TOTAL');\r\n\t\tconst totalValue = totalInput && parseInt(totalInput.val()) || 0;\r\n\r\n\t\treturn (currentValue > 0 && currentValue === totalValue);\r\n\t},\r\n\r\n\tcommit: function(boxIndex) {\r\n\t\tconst count = this.getCount();\r\n\t\tconst initialCount = this.getInitialCount();\r\n\t\tconst boxIndexInput = this.getInput('INITIAL_BOX');\r\n\t\tlet changed = false;\r\n\r\n\t\tif (count !== initialCount) {\r\n\t\t\tchanged = true;\r\n\t\t\tthis.setInitialCount(count);\r\n\t\t}\r\n\r\n\t\tboxIndexInput && boxIndexInput.val(boxIndex);\r\n\r\n\t\treturn changed;\r\n\t},\r\n\r\n\tgetTitle: function() {\r\n\t\tconst name = this.getInput('NAME');\r\n\r\n\t\treturn name && name.text();\r\n\t},\r\n\r\n\tgetCountDiff: function() {\r\n\t\tlet result;\r\n\r\n\t\tif (this.needDelete()) {\r\n\t\t\tresult = this.getInitialCount();\r\n\t\t} else {\r\n\t\t\tresult = this.getInitialCount() - this.getCount();\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tsetCount: function(count) {\r\n\t\tconst input = this.getInput('COUNT');\r\n\r\n\t\tinput.val(count);\r\n\t},\r\n\r\n\tgetCount: function() {\r\n\t\tconst input = this.getInput('COUNT');\r\n\r\n\t\treturn input !== null ? parseInt(input.val()) : null;\r\n\t},\r\n\r\n\trecalculateOffset: function() {\r\n\t\tconst sameItems = this.getBasket().getBox().getCollection().sameBasketItems(this);\r\n\t\tlet offset = 0;\r\n\r\n\t\tfor (const sameItem of sameItems) {\r\n\t\t\tsameItem.setOffset(offset);\r\n\r\n\t\t\tif (!sameItem.isPart() || sameItem.isFinalPart()) {\r\n\t\t\t\toffset += sameItem.getInitialCount();\r\n\t\t\t}\r\n\r\n\t\t\tsameItem.updateCisCount();\r\n\t\t}\r\n\t},\r\n\r\n\tsetOffset: function(offset) {\r\n\t\tconst input = this.getInput('OFFSET');\r\n\r\n\t\tinput.val(offset || 0);\r\n\t},\r\n\r\n\tgetOffset: function() {\r\n\t\tconst input = this.getInput('OFFSET');\r\n\r\n\t\treturn input !== null ? parseInt(input.val()) : null;\r\n\t},\r\n\r\n\tgetInitialCount: function() {\r\n\t\tconst input = this.getInput('INITIAL_COUNT');\r\n\r\n\t\treturn input !== null ? parseInt(input.val()) : null;\r\n\t},\r\n\r\n\tsetInitialCount: function(count) {\r\n\t\tconst countInput = this.getInput('COUNT');\r\n\t\tconst initialInput = this.getInput('INITIAL_COUNT');\r\n\r\n\t\tinitialInput?.val(count);\r\n\t\tcountInput?.prop('max', count);\r\n\t},\r\n\r\n\tneedDelete: function() {\r\n\t\tconst input = this.getInput('DELETE');\r\n\r\n\t\treturn input && input.val() === 'Y';\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tif (this.needDelete()) { return; }\r\n\r\n\t\tconst fields = [\r\n\t\t\tthis.getCis(),\r\n\t\t\tthis.getDigital(),\r\n\t\t];\r\n\r\n\t\tfor (const field of fields) {\r\n\t\t\tfield && field.validate();\r\n\t\t}\r\n\t},\r\n\r\n\tgetCis: function() {\r\n\t\treturn this.getChildField('IDENTIFIERS');\r\n\t},\r\n\r\n\tgetDigital: function() {\r\n\t\treturn this.getChildField('DIGITAL');\r\n\t},\r\n\r\n\tgetBasket: function() {\r\n\t\treturn this.getParentField();\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBasketItem',\r\n\tpluginName: 'YandexMarket.OrderView.BasketItem',\r\n});\r\n\r\nexport const BasketItem = constructor;","import { BasketItem } from \"./basketitem\";\r\n\r\nconst BX = window.BX;\r\nconst FieldReference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = FieldReference.Collection.extend({\r\n\r\n\tdefaults: {\r\n\t\titemElement: '.js-yamarket-basket-item'\r\n\t},\r\n\r\n\tinsertItem: function(itemElement) {\r\n\t\titemElement.detach();\r\n\t\titemElement.addClass('is--hidden');\r\n\t\titemElement.appendTo(this.$el);\r\n\r\n\t\treturn this.addItem(itemElement, null, null, true);\r\n\t},\r\n\r\n\tsameBasketItems: function(target) {\r\n\t\tconst targetId = target.id();\r\n\t\tconst result = [];\r\n\r\n\t\tthis.callItemList((item) => {\r\n\t\t\tif (item.id() === targetId) {\r\n\t\t\t\tresult.push(item);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\taddItem: function(source, context, method, isCopy) {\r\n\t\tconst item = this.callParent('addItem', [source, context, method, isCopy], constructor);\r\n\r\n\t\tthis.refreshItemMove();\r\n\r\n\t\treturn item;\r\n\t},\r\n\r\n\tdeleteItem: function(item, silent) {\r\n\t\tthis.callParent('deleteItem', [item, silent], constructor);\r\n\t\tthis.refreshItemMove();\r\n\t},\r\n\r\n\trefreshItemMove: function() {\r\n\t\tconst box = this.getBox();\r\n\t\tconst previousBox = box.getCollection().getPreviousMovableBox(box);\r\n\t\tconst nextBox = box.getCollection().getNextMovableBox(box);\r\n\t\tconst hasPrevious = previousBox != null && previousBox.getBasket().getActiveItems().length > 0;\r\n\t\tconst hasNext = nextBox != null && nextBox.getBasket().getActiveItems().length > 0;\r\n\t\tconst hasFewItems = this.getActiveItems().length > 1;\r\n\r\n\t\tthis.callItemList('refreshMoveUp', [hasPrevious]);\r\n\t\tthis.callItemList('refreshMoveDown', [hasNext || hasFewItems]);\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tthis.callItemList((basketItem) => {\r\n\t\t\ttry {\r\n\t\t\t\tbasketItem.validate()\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconst title = basketItem.getTitle();\r\n\t\t\t\tconst message = (title ? title + ': ' : '') + e.message;\r\n\r\n\t\t\t\tthrow new Error(message);\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\tcommit: function(boxIndex) {\r\n\t\tlet hasChanges = false;\r\n\t\tlet activeCount = 0;\r\n\r\n\t\tthis.callItemList((basketItem) => {\r\n\t\t\tlet count = basketItem.getCount();\r\n\r\n\t\t\tif (count <= 0 || basketItem.needDelete()) {\r\n\t\t\t\thasChanges = true;\r\n\t\t\t\tthis.deleteItem(basketItem.$el);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (basketItem.commit(boxIndex)) {\r\n\t\t\t\thasChanges = true;\r\n\t\t\t}\r\n\r\n\t\t\t++activeCount;\r\n\t\t});\r\n\r\n\t\tif (activeCount === 0) {\r\n\t\t\tconst box = this.getBox();\r\n\t\t\tbox.getCollection().deleteItem(box.$el);\r\n\t\t}\r\n\r\n\t\treturn hasChanges;\r\n\t},\r\n\r\n\tgetCountChanges: function() {\r\n\t\tconst result = [];\r\n\r\n\t\tthis.callItemList((basketItem) => {\r\n\t\t\tlet diff = basketItem.getCountDiff();\r\n\r\n\t\t\tif (diff <= 0 || (basketItem.isPart() && !basketItem.isFinalPart())) { return; }\r\n\r\n\t\t\tresult.push({\r\n\t\t\t\tname: basketItem.getTitle(),\r\n\t\t\t\tdiff: diff,\r\n\t\t\t});\r\n\t\t});\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetItemPlugin: function() {\r\n\t\treturn BasketItem;\r\n\t},\r\n\r\n\tgetBox: function() {\r\n\t\treturn this.getParentField();\r\n\t}\r\n\r\n}, {\r\n\tdataName: 'orderViewBasket',\r\n\tpluginName: 'YandexMarket.OrderView.Basket',\r\n});\r\n\r\nexport const Basket = constructor;","const BX = window.BX;\r\nconst Reference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = Reference.Base.extend({\r\n\r\n\tdefaults: {\r\n\t\tinputElement: '.js-yamarket-basket-item-cis__input',\r\n\t\tcopyElement: '.js-yamarket-basket-item-cis__copy',\r\n\t\trowElement: '.js-yamarket-basket-item-cis__row',\r\n\t\tcopy: null,\r\n\r\n\t\tlang: {},\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_ITEM_CIS_'\r\n\t},\r\n\r\n\tinitialize: function() {\r\n\t\tthis.callParent('initialize', constructor);\r\n\t\tthis.bind();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('destroy', constructor);\r\n\t},\r\n\r\n\tbind: function() {\r\n\t\tthis.handleCopyClick(true);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleCopyClick(false);\r\n\t},\r\n\r\n\thandleCopyClick: function(dir) {\r\n\t\tconst copy = this.getElement('copy');\r\n\r\n\t\tcopy[dir ? 'on' : 'off']('click', $.proxy(this.onCopyClick, this));\r\n\t},\r\n\r\n\tonCopyClick: function(evt) {\r\n\t\tthis.copy();\r\n\t\tevt.preventDefault();\r\n\t},\r\n\r\n\tcopy: function() {\r\n\t\tconst copyValues = this.getCopyValue();\r\n\t\tconst values = this.getValue();\r\n\r\n\t\tObject.assign(values, copyValues);\r\n\r\n\t\tthis.setValue(values);\r\n\t},\r\n\r\n\tgetCopyValue: function() {\r\n\t\tconst parent = this.getParentField();\r\n\t\tlet result;\r\n\r\n\t\tif (this.options.copy != null) {\r\n\t\t\tresult = this.options.copy;\r\n\t\t} else if (parent != null) {\r\n\t\t\tresult = parent.getCopyValue();\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tsetBasketCount: function(count, offset) {\r\n\t\tconst rows = this.getElement('row');\r\n\r\n\t\tfor (let i = 0; i < rows.length; ++i) {\r\n\t\t\tconst row = rows.eq(i);\r\n\r\n\t\t\tif (i >= offset && i < offset + count) {\r\n\t\t\t\trow.removeClass('is--hidden');\r\n\t\t\t\trow.find('input').prop('disabled', false);\r\n\t\t\t} else {\r\n\t\t\t\trow.addClass('is--hidden');\r\n\t\t\t\trow.find('input').prop('disabled', true);\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBasketItemCis',\r\n\tpluginName: 'YandexMarket.OrderView.BasketItemCis',\r\n});\r\n\r\nexport const BasketItemCis = constructor;","import {BasketItemCis} from \"./basketitemcis\";\r\n\r\nconst BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst YandexMarket = BX.namespace('YandexMarket');\r\nconst Reference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = Reference.Summary.extend({\r\n\r\n\tdefaults: {\r\n\t\tsummaryElement: '.js-yamarket-basket-item-cis__summary',\r\n\t\tfieldElement: '.js-yamarket-basket-item-cis__field',\r\n\t\tmodalElement: '.js-yamarket-basket-item-cis__modal',\r\n\t\tmodalWidth: 400,\r\n\t\tmodalHeight: 300,\r\n\t\trequiredTypes: '',\r\n\t\toptionalTypes: '',\r\n\r\n\t\tcopyElement: '.js-yamarket-basket-item-cis__summary-copy',\r\n\t\tcopy: null,\r\n\r\n\t\tlang: {},\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_ITEM_CIS_'\r\n\t},\r\n\r\n\tinitialize: function() {\r\n\t\tthis.callParent('initialize', constructor);\r\n\t\tthis.bind();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('destroy', constructor);\r\n\t},\r\n\r\n\tbind: function() {\r\n\t\tthis.handleSummaryClick(true);\r\n\t\tthis.handleCopyClick(true);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleSummaryClick(false);\r\n\t\tthis.handleCopyClick(false);\r\n\t},\r\n\r\n\thandleSummaryClick: function(dir) {\r\n\t\tconst summary = this.getElement('summary');\r\n\r\n\t\tsummary[dir ? 'on' : 'off']('click', $.proxy(this.onSummaryClick, this));\r\n\t},\r\n\r\n\thandleCopyClick: function(dir) {\r\n\t\tconst copy = this.getElement('copy');\r\n\r\n\t\tcopy[dir ? 'on' : 'off']('click', $.proxy(this.onCopyClick, this));\r\n\t},\r\n\r\n\tonSummaryClick: function(evt) {\r\n\t\tthis.openEditModal();\r\n\t\tevt.preventDefault();\r\n\t},\r\n\r\n\tonCopyClick: function(evt) {\r\n\t\tthis.copy();\r\n\t\tthis.refreshSummary();\r\n\t\tevt.preventDefault();\r\n\t},\r\n\r\n\tupdateField: function(modalContent) {\r\n\t\tthis.callParent('updateField', [modalContent], constructor);\r\n\t\tthis.syncSameBasketItems();\r\n\t},\r\n\r\n\tsyncSameBasketItems: function() {\r\n\t\tconst ourBasketItem = this.getBasketItem();\r\n\t\tconst sameBasketItems = ourBasketItem.getBasket().getBox().getCollection().sameBasketItems(ourBasketItem);\r\n\r\n\t\tif (sameBasketItems.length === 1) { return; }\r\n\r\n\t\tconst fieldName = this.$el.data('name');\r\n\t\tconst value = this.getValue();\r\n\r\n\t\tfor (const siblingBasketItem of sameBasketItems) {\r\n\t\t\tif (siblingBasketItem === ourBasketItem) { continue; }\r\n\r\n\t\t\tconst siblingCis = siblingBasketItem.getChildField(fieldName);\r\n\r\n\t\t\tif (siblingCis == null) { continue; }\r\n\r\n\t\t\tsiblingCis.setValue(value);\r\n\r\n\t\t\tif (siblingBasketItem.isPart()) {\r\n\t\t\t\tsiblingCis.refreshSummary();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tconst valueList = this.getValue();\r\n\t\tconst status = this.getCisStatus(valueList);\r\n\r\n\t\tif (status === 'WAIT') {\r\n\t\t\tthrow new Error(this.getLang('REQUIRED'));\r\n\t\t}\r\n\t},\r\n\r\n\trefreshSummary: function() {\r\n\t\tconst valueList = this.getValue();\r\n\t\tconst status = this.getCisStatus(valueList);\r\n\t\tconst statusText = this.getLang('SUMMARY_' + status) || status;\r\n\t\tconst summary = this.getElement('summary');\r\n\r\n\t\tsummary.text(statusText);\r\n\t\tsummary.attr('data-status', status);\r\n\t},\r\n\r\n\tgetCisStatus: function(valueList) {\r\n\t\tconst basketItem = this.getBasketItem();\r\n\t\tconst count = basketItem.getCount();\r\n\t\tconst [filled, optional]= this.getFilledCount(valueList, count, basketItem.getOffset());\r\n\t\tlet result;\r\n\r\n\t\tif (filled >= count) {\r\n\t\t\tresult = 'READY';\r\n\t\t} else if (optional >= count) {\r\n\t\t\tresult = 'OPTIONAL';\r\n\t\t} else {\r\n\t\t\tresult = 'WAIT';\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetFilledCount: function(valueList, count, offset) {\r\n\t\tconst types = this.requiredTypes();\r\n\t\tconst optionalTypes = this.optionalTypes();\r\n\t\tlet filled = 0;\r\n\t\tlet optional = 0;\r\n\r\n\t\tfor (let i = offset; i < offset + count; ++i) {\r\n\t\t\tlet itemFilled = 0;\r\n\t\t\tlet itemOptional = 0;\r\n\r\n\t\t\tfor (const type of types) {\r\n\t\t\t\tconst name = `[ITEMS][${i}][${type}]`;\r\n\t\t\t\tconst value = valueList[name] ?? '';\r\n\r\n\t\t\t\tif (value.trim() !== '') {\r\n\t\t\t\t\t++itemFilled;\r\n\t\t\t\t\t++itemOptional;\r\n\t\t\t\t} else if (optionalTypes.indexOf(type) !== -1) {\r\n\t\t\t\t\t++itemOptional;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (itemFilled >= types.length) {\r\n\t\t\t\t++filled;\r\n\t\t\t}\r\n\r\n\t\t\tif (itemOptional >= types.length) {\r\n\t\t\t\t++optional;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn [filled, optional];\r\n\t},\r\n\r\n\tgetBasketCount: function() {\r\n\t\treturn this.getBasketItem().getCount();\r\n\t},\r\n\r\n\tsetBasketCount: function(count, offset) {\r\n\t\tthis.callField('setBasketCount', [count, offset]);\r\n\t},\r\n\r\n\trequiredTypes: function() {\r\n\t\tconst option = this.options.requiredTypes || '';\r\n\r\n\t\treturn option.split(',');\r\n\t},\r\n\r\n\toptionalTypes: function() {\r\n\t\tconst option = this.options.optionalTypes || '';\r\n\r\n\t\treturn option.split(',');\r\n\t},\r\n\r\n\tcopy: function() {\r\n\t\tconst copyValues = this.getCopyValue();\r\n\t\tconst values = this.getValue();\r\n\r\n\t\tObject.assign(values, copyValues);\r\n\r\n\t\tthis.setValue(values);\r\n\t},\r\n\r\n\tgetCopyValue: function() {\r\n\t\treturn this.options.copy;\r\n\t},\r\n\r\n\tgetFieldPlugin: function() {\r\n\t\treturn BasketItemCis;\r\n\t},\r\n\r\n\tgetBasketItem: function() {\r\n\t\treturn this.getParentField();\r\n\t},\r\n\r\n\tcreateModal: function() {\r\n\t\treturn new YandexMarket.EditDialog({\r\n\t\t\t'title': this.options.title,\r\n\t\t\t'draggable': true,\r\n\t\t\t'resizable': true,\r\n\t\t\t'buttons': [YandexMarket.EditDialog.btnSave, YandexMarket.EditDialog.btnCancel],\r\n\t\t\t'width': this.options.modalWidth,\r\n\t\t\t'height': this.options.modalHeight\r\n\t\t});\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBasketItemCisSummary',\r\n\tpluginName: 'YandexMarket.OrderView.BasketItemCisSummary',\r\n});\r\n\r\nexport const BasketItemCisSummary = constructor;","const BX = window.BX;\r\nconst Reference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = Reference.Base.extend({\r\n\r\n\tdefaults: {\r\n\t\tinputElement: '.js-yamarket-basket-item-digital__input',\r\n\r\n\t\tlang: {},\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_ITEM_DIGITAL_'\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBasketItemDigital',\r\n\tpluginName: 'YandexMarket.OrderView.BasketItemDigital',\r\n});\r\n\r\nexport const BasketItemDigital = constructor;","import {BasketItemDigital} from \"./basketitemdigital\";\r\n\r\nconst BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst Reference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = Reference.Summary.extend({\r\n\r\n\tdefaults: {\r\n\t\tsummaryElement: '.js-yamarket-basket-item-digital__summary',\r\n\t\tfieldElement: '.js-yamarket-basket-item-digital__field',\r\n\t\tmodalElement: '.js-yamarket-basket-item-digital__modal',\r\n\t\tmodalWidth: 450,\r\n\t\tmodalBaseHeight: 160,\r\n\t\tmodalOneHeight: 140,\r\n\t\tcount: 1,\r\n\r\n\t\tlang: {},\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_ITEM_DIGITAL_'\r\n\t},\r\n\r\n\tinitVars: function() {\r\n\t\tthis.callParent('initVars', constructor);\r\n\t\tthis._basketCount = null;\r\n\t},\r\n\r\n\tinitialize: function() {\r\n\t\tthis.callParent('initialize', constructor);\r\n\t\tthis.bind();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('destroy', constructor);\r\n\t},\r\n\r\n\tbind: function() {\r\n\t\tthis.handleSummaryClick(true);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleSummaryClick(false);\r\n\t},\r\n\r\n\thandleSummaryClick: function(dir) {\r\n\t\tconst summary = this.getElement('summary');\r\n\r\n\t\tsummary[dir ? 'on' : 'off']('click', $.proxy(this.onSummaryClick, this));\r\n\t},\r\n\r\n\tonSummaryClick: function(evt) {\r\n\t\tthis.resolveModalHeight();\r\n\t\tthis.openEditModal();\r\n\r\n\t\tevt.preventDefault();\r\n\t},\r\n\r\n\tresolveModalHeight: function() {\r\n\t\tthis.options.modalHeight = this.options.modalBaseHeight + (this.options.modalOneHeight * this.options.count);\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tconst raw = this.getValue();\r\n\t\tconst values = this.parseValue(raw);\r\n\t\tconst status = this.getDigitalStatus(values);\r\n\r\n\t\tif (status === 'WAIT') {\r\n\t\t\tthrow new Error(this.getLang('REQUIRED'));\r\n\t\t}\r\n\t},\r\n\r\n\trefreshSummary: function() {\r\n\t\tconst raw = this.getValue();\r\n\t\tconst values = this.parseValue(raw);\r\n\t\tconst status = this.getDigitalStatus(values);\r\n\t\tconst statusText = this.getLang('SUMMARY_' + status) || status;\r\n\t\tconst summary = this.getElement('summary');\r\n\r\n\t\tsummary.text(statusText);\r\n\t\tsummary.attr('data-status', status);\r\n\t},\r\n\r\n\tparseValue: function(values) {\r\n\t\tconst result = {};\r\n\r\n\t\tfor (const key in values) {\r\n\t\t\tif (!values.hasOwnProperty(key)) { continue; }\r\n\r\n\t\t\tconst keyChain = this.valueKeyChain(key);\r\n\r\n\t\t\tthis.setValueByKeyChain(result, keyChain, values[key]);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tvalueKeyChain: function(key) {\r\n\t\tconst parts = key.split('[');\r\n\t\tconst result = [];\r\n\r\n\t\tfor (const part of parts) {\r\n\t\t\tif (part === '' && result.length === 0) { continue; }\r\n\r\n\t\t\tconst name = part.replace(/]$/, '');\r\n\r\n\t\t\tresult.push(name);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tsetValueByKeyChain: function(result, chain, value) {\r\n\t\tconst lastKey = chain.pop();\r\n\t\tlet level = result;\r\n\r\n\t\tfor (let index = 0; index < chain.length; ++index) {\r\n\t\t\tconst key = chain[index];\r\n\t\t\tconst nextKey = (index + 1 === chain.length) ? lastKey : chain[index + 1];\r\n\r\n\t\t\tif (level[key] == null) {\r\n\t\t\t\tlevel[key] = /^\\d+$/.test(nextKey) ? [] : {};\r\n\t\t\t}\r\n\r\n\t\t\tlevel = level[key];\r\n\t\t}\r\n\r\n\t\tlevel[lastKey] = value;\r\n\t},\r\n\r\n\tgetDigitalStatus: function(values) {\r\n\t\tconst filled = this.getFilledCount(values);\r\n\t\tconst total = this.getBasketCount();\r\n\t\tlet result;\r\n\r\n\t\tif (filled >= total) {\r\n\t\t\tresult = 'READY';\r\n\t\t} else {\r\n\t\t\tresult = 'WAIT';\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetFilledCount: function(values) {\r\n\t\tlet result = 0;\r\n\r\n\t\tif (values['ITEM'] == null || !Array.isArray(values['ITEM'])) { return result; }\r\n\r\n\t\tfor (const item of values['ITEM']) {\r\n\t\t\tif (item['CODE'] !== '' && item['ACTIVATE_TILL'] !== '') {\r\n\t\t\t\t++result;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetBasketCount: function() {\r\n\t\treturn (this._basketCount != null ? this._basketCount : this.options.count);\r\n\t},\r\n\r\n\tsetBasketCount: function(count) {\r\n\t\tthis._basketCount = count;\r\n\t},\r\n\r\n\tgetFieldPlugin: function() {\r\n\t\treturn BasketItemDigital;\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBasketItemDigitalSummary',\r\n\tpluginName: 'YandexMarket.OrderView.BasketItemDigitalSummary',\r\n});\r\n\r\nexport const BasketItemDigitalSummary = constructor;","const BX = window.BX;\r\nconst FieldReference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = FieldReference.Base.extend({\r\n\r\n\tdefaults: {\r\n\t\tinputElement: '.js-yamarket-basket-confirm-form__input',\r\n\t\tproductsElement: '.js-yamarket-basket-confirm-form__products',\r\n\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_CONFIRM_',\r\n\t\tlang: {},\r\n\t},\r\n\r\n\tallowRemove: function(allow) {\r\n\t\tconst input = this.getInput('ALLOW_REMOVE');\r\n\r\n\t\tinput.val(allow ? 'Y' : '');\r\n\t},\r\n\r\n\tsetItemsChanges: function(changes) {\r\n\t\tconst element = this.getElement('products');\r\n\t\tconst text = this.compileItemsChanges(changes);\r\n\r\n\t\telement.html(text);\r\n\t},\r\n\r\n\tcompileItemsChanges: function(changes) {\r\n\t\tconst rows = [];\r\n\r\n\t\tfor (const change of changes) {\r\n\t\t\trows.push(this.getLang('ITEM_CHANGE', {\r\n\t\t\t\tNAME: change.name,\r\n\t\t\t\tCOUNT: change.diff,\r\n\t\t\t}));\r\n\t\t}\r\n\r\n\t\treturn rows.join('<hr />');\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBasketConfirmForm',\r\n\tpluginName: 'YandexMarket.OrderView.BasketConfirmForm',\r\n});\r\n\r\nexport const BasketConfirmForm = constructor;","import { BasketConfirmForm } from \"./basketconfirmform\";\r\n\r\nconst BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst FieldReference = BX.namespace('YandexMarket.Field.Reference');\r\n\r\nconst constructor = FieldReference.Summary.extend({\r\n\r\n\tdefaults: {\r\n\t\tmodalElement: '.js-yamarket-basket-confirm-summary__modal',\r\n\t\tfieldElement: '.js-yamarket-basket-confirm-summary__field',\r\n\r\n\t\tmodalWidth: 500,\r\n\t\tmodalHeight: 350,\r\n\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_BASKET_CONFIRM_',\r\n\t\tlang: {},\r\n\t},\r\n\r\n\tinitVars: function() {\r\n\t\tthis.callParent('initVars', constructor);\r\n\t\tthis._confirmDeferred = null;\r\n\t},\r\n\r\n\tonEditModalSave: function() {\r\n\t\tthis.callParent('onEditModalSave', constructor);\r\n\t\tthis.allowRemove(true);\r\n\t\tthis.resolveConfirm();\r\n\t},\r\n\r\n\tonEditModalClose: function() {\r\n\t\tthis.callParent('onEditModalClose', constructor);\r\n\t\tthis.allowRemove(false);\r\n\t\tthis.rejectConfirm();\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\t// nothing\r\n\t},\r\n\r\n\tconfirm: function(boxCollection) {\r\n\t\tconst changes = boxCollection.getCountChanges();\r\n\r\n\t\tif (changes.length === 0) {\r\n\t\t\tthis.allowRemove(false);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.setItemsChanges(changes);\r\n\t\tthis.initEdit();\r\n\r\n\t\treturn this.waitConfirm();\r\n\t},\r\n\r\n\tallowRemove: function(allow) {\r\n\t\tthis.callField('allowRemove', [allow]);\r\n\t},\r\n\r\n\tsetItemsChanges: function(changes) {\r\n\t\tthis.callField('setItemsChanges', [changes]);\r\n\t},\r\n\r\n\twaitConfirm: function() {\r\n\t\tthis._confirmDeferred = new $.Deferred();\r\n\r\n\t\treturn this._confirmDeferred;\r\n\t},\r\n\r\n\tresolveConfirm: function() {\r\n\t\tconst deferred = this._confirmDeferred;\r\n\r\n\t\tif (deferred === null) { return; }\r\n\r\n\t\tthis._confirmDeferred = null;\r\n\t\tdeferred.resolve();\r\n\t},\r\n\r\n\trejectConfirm: function() {\r\n\t\tconst deferred = this._confirmDeferred;\r\n\r\n\t\tif (deferred === null) { return; }\r\n\r\n\t\tthis._confirmDeferred = null;\r\n\t\tdeferred.reject();\r\n\t},\r\n\r\n\tgetFieldPlugin: function() {\r\n\t\treturn BasketConfirmForm;\r\n\t},\r\n\r\n\tgetLang: function(key, replaces) {\r\n\t\tif (key === 'MODAL_TITLE' && this.callField('getInput', ['REASON']) != null) {\r\n\t\t\tkey = 'MODAL_TITLE_WITH_REASON';\r\n\t\t}\r\n\r\n\t\treturn this.callParent('getLang', [key, replaces], constructor);\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewBasketConfirmSummary',\r\n\tpluginName: 'YandexMarket.OrderView.BasketConfirmSummary',\r\n});\r\n\r\nexport const BasketConfirmSummary = constructor;","const BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst YandexMarket = BX.namespace('YandexMarket');\r\nconst Plugin = BX.namespace('YandexMarket.Plugin');\r\n\r\nconst constructor = Plugin.Base.extend({\r\n\r\n\tdefaults: {\r\n\t\turl: null,\r\n\t\twidth: 400,\r\n\t\theight: 300,\r\n\t\titems: [],\r\n\t},\r\n\r\n\tinitialize: function() {\r\n\t\tthis.callParent('initialize', constructor);\r\n\t\tthis.bind();\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('initialize', constructor);\r\n\t},\r\n\r\n\tbind: function() {\r\n\t\tthis.handleClick(true);\r\n\t\tthis.handleShipmentSubmit(true);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleClick(false);\r\n\t\tthis.handleShipmentSubmit(false);\r\n\t},\r\n\r\n\thandleClick: function(dir) {\r\n\t\tthis.$el[dir ? 'on' : 'off']('click', $.proxy(this.onClick, this));\r\n\t},\r\n\r\n\thandleShipmentSubmit: function(dir) {\r\n\t\tif (!dir || this.isDisabled()) {\r\n\t\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent']('yamarketShipmentSubmitEnd', BX.proxy(this.onShipmentSubmitEnd, this));\r\n\t\t}\r\n\t},\r\n\r\n\tonShipmentSubmitEnd: function(status) {\r\n\t\tif (status === 'ok') {\r\n\t\t\tthis.enable();\r\n\t\t\tthis.handleShipmentSubmit(false);\r\n\t\t}\r\n\t},\r\n\r\n\tonClick: function() {\r\n\t\tthis.createDropdown();\r\n\t\tthis.handleClick(false);\r\n\t},\r\n\r\n\tisDisabled: function() {\r\n\t\treturn this.$el.hasClass('is--hidden');\r\n\t},\r\n\r\n\tenable: function() {\r\n\t\tthis.$el.removeClass('is--hidden');\r\n\t},\r\n\r\n\tcreateDropdown: function() {\r\n\t\tconst items = this.getDropdownItems();\r\n\r\n\t\tBX.adminShowMenu(this.el, items);\r\n\t},\r\n\r\n\tgetDropdownItems: function() {\r\n\t\tconst result = [];\r\n\t\tconst items = this.options.items;\r\n\t\tlet itemIndex;\r\n\t\tlet item;\r\n\r\n\t\tfor (itemIndex = 0; itemIndex < items.length; itemIndex++) {\r\n\t\t\titem = items[itemIndex];\r\n\r\n\t\t\tresult.push({\r\n\t\t\t\tTEXT: item.TITLE,\r\n\t\t\t\tACTION: this.openDialog.bind(this, item.TYPE),\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\topenDialog: function(type) {\r\n\t\tconst item = this.getItem(type);\r\n\t\tconst url = this.buildUrl(item);\r\n\t\tconst dialog = this.createDialog(url, item);\r\n\r\n\t\tdialog.Show();\r\n\t},\r\n\r\n\tcreateDialog: function(url, item) {\r\n\t\treturn new YandexMarket.PrintDialog({\r\n\t\t\ttitle: item.DIALOG_TITLE || item.TITLE,\r\n\t\t\tcontent_url: url,\r\n\t\t\twidth: item.WIDTH || this.options.width,\r\n\t\t\theight: item.HEIGHT || this.options.height,\r\n\t\t\tbuttons: [\r\n\t\t\t\tYandexMarket.PrintDialog.btnSave,\r\n\t\t\t\tYandexMarket.PrintDialog.btnCancel\r\n\t\t\t]\r\n\t\t});\r\n\t},\r\n\r\n\tbuildUrl: function(item) {\r\n\t\tlet result = this.options.url;\r\n\r\n\t\tresult +=\r\n\t\t\t(result.indexOf('?') === -1 ? '?' : '&')\r\n\t\t\t+ 'type=' + item.TYPE;\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tgetItem: function(type) {\r\n\t\tconst items = this.options.items;\r\n\t\tlet result;\r\n\t\tlet itemIndex;\r\n\t\tlet item;\r\n\r\n\t\tfor (itemIndex = 0; itemIndex < items.length; itemIndex++) {\r\n\t\t\titem = items[itemIndex];\r\n\r\n\t\t\tif (item.TYPE === type) {\r\n\t\t\t\tresult = item;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewShipmentPrint',\r\n\tpluginName: 'YandexMarket.OrderView.ShipmentPrint',\r\n});\r\n\r\nexport const ShipmentPrint = constructor;","const BX = window.BX;\r\nconst $ = window.jQuery;\r\nconst Plugin = BX.namespace('YandexMarket.Plugin');\r\nconst utils = BX.namespace('YandexMarket.Utils');\r\n\r\nconst constructor = Plugin.Base.extend({\r\n\r\n\tdefaults: {\r\n\t\turl: 'yamarket_trading_shipment_submit.php',\r\n\r\n\t\tmessageElement: '.js-yamarket-shipment-submit__message',\r\n\t\tmessageRowTemplate: '<div class=\"yamarket-shipment-submit__result-row\" data-status=\"#STATUS#\">#TEXT#</div>',\r\n\r\n\t\torderElement: '.js-yamarket-order',\r\n\r\n\t\tlang: {},\r\n\t\tlangPrefix: 'YANDEX_MARKET_T_TRADING_ORDER_VIEW_SHIPMENT_SUBMIT_'\r\n\t},\r\n\r\n\tinitVars: function() {\r\n\t\tthis.callParent('initVars', constructor);\r\n\t\tthis._handleBoxCollectionChange = false;\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.unbind();\r\n\t\tthis.callParent('initialize', constructor);\r\n\t},\r\n\r\n\tunbind: function() {\r\n\t\tthis.handleShipmentChange(false);\r\n\t\tthis.handleBoxCollectionChange(false);\r\n\t},\r\n\r\n\thandleShipmentChange: function(dir) {\r\n\t\tconst orderElement = this.getOrderElement();\r\n\r\n\t\torderElement[dir ? 'on' : 'off']('change', $.proxy(this.onOrderChange, this));\r\n\t},\r\n\r\n\thandleBoxCollectionChange: function(dir) {\r\n\t\tif (this._handleBoxCollectionChange === dir) { return; }\r\n\r\n\t\tthis._handleBoxCollectionChange = dir;\r\n\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent']('yamarketOrderViewBoxCollectionAddItem', BX.proxy(this.onBoxCollectionModify, this));\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent']('yamarketOrderViewBoxCollectionDeleteItem', BX.proxy(this.onBoxCollectionModify, this));\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent']('yamarketOrderViewBoxItemCollectionAddItem', BX.proxy(this.onBoxCollectionModify, this));\r\n\t\tBX[dir ? 'addCustomEvent' : 'removeCustomEvent']('yamarketOrderViewBoxItemCollectionDeleteItem', BX.proxy(this.onBoxCollectionModify, this));\r\n\t},\r\n\r\n\tonOrderChange: function() {\r\n\t\tthis.handleShipmentChange(false);\r\n\t\tthis.handleBoxCollectionChange(false);\r\n\t\tthis.clear();\r\n\t},\r\n\r\n\tonBoxCollectionModify: function(instance) {\r\n\t\tconst orderElement = this.getOrderElement();\r\n\r\n\t\tif ($.contains(orderElement[0], instance.el)) {\r\n\t\t\tthis.handleShipmentChange(false);\r\n\t\t\tthis.handleBoxCollectionChange(false);\r\n\t\t\tthis.clear();\r\n\t\t}\r\n\t},\r\n\r\n\tclear: function() {\r\n\t\tthis.showMessage('', '');\r\n\t},\r\n\r\n\tactivate: function() {\r\n\t\tif (this.el.disabled) { return; }\r\n\t\tif (!this.validate()) { return; }\r\n\r\n\t\t$.when(this.confirm())\r\n\t\t\t.then(() => {\r\n\t\t\t\tthis.el.disabled = true;\r\n\r\n\t\t\t\tthis.clear();\r\n\t\t\t\tthis.query().then(\r\n\t\t\t\t\t$.proxy(this.activateEnd, this),\r\n\t\t\t\t\t$.proxy(this.activateStop, this)\r\n\t\t\t\t);\r\n\t\t\t});\r\n\t},\r\n\r\n\tactivateStop: function(xhr, reason) {\r\n\t\tconst message = this.getLang('FAIL', { 'REASON': reason });\r\n\r\n\t\tthis.el.disabled = false;\r\n\t\tthis.showMessage(message, 'error');\r\n\r\n\t\tthis.handleShipmentChange(true);\r\n\t\tthis.handleBoxCollectionChange(true);\r\n\t},\r\n\r\n\tactivateEnd: function(data) {\r\n\t\tlet status;\r\n\r\n\t\tthis.el.disabled = false;\r\n\r\n\t\tif (typeof data !== 'object' || data.status == null) {\r\n\t\t\tstatus = 'error';\r\n\t\t\tthis.showMessage(this.getLang('DATA_INVALID'), 'error');\r\n\t\t} else {\r\n\t\t\tstatus = data.status;\r\n\r\n\t\t\tif (data.messages != null) {\r\n\t\t\t\tthis.showMessages(data.messages);\r\n\t\t\t} else {\r\n\t\t\t\tthis.showMessage(data.message, status);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (status === 'ok') {\r\n\t\t\tthis.commit();\r\n\t\t}\r\n\r\n\t\tthis.handleShipmentChange(true);\r\n\t\tthis.handleBoxCollectionChange(true);\r\n\r\n\t\tBX.onCustomEvent(this.el, 'yamarketShipmentSubmitEnd', [status]);\r\n\t},\r\n\r\n\tvalidate: function() {\r\n\t\tlet result = true;\r\n\t\tlet confirmMessage;\r\n\r\n\t\ttry {\r\n\t\t\tthis.getOrder().validate();\r\n\t\t} catch (e) {\r\n\t\t\tconfirmMessage = this.getLang('VALIDATION_CONFIRM', { MESSAGE: e.message });\r\n\t\t\tresult = confirm(confirmMessage || e.message);\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t},\r\n\r\n\tconfirm: function() {\r\n\t\treturn this.getOrder().confirm();\r\n\t},\r\n\r\n\tcommit: function() {\r\n\t\tthis.getOrder().commit();\r\n\t},\r\n\r\n\tquery: function() {\r\n\t\treturn $.ajax({\r\n\t\t\turl: this.options.url,\r\n\t\t\ttype: 'POST',\r\n\t\t\tdata: this.getQueryData(),\r\n\t\t\tdataType: 'json'\r\n\t\t});\r\n\t},\r\n\r\n\tgetQueryData: function() {\r\n\t\tconst data = this.getFormData();\r\n\r\n\t\tdata.push({\r\n\t\t\tname: 'sessid',\r\n\t\t\tvalue: BX.bitrix_sessid()\r\n\t\t});\r\n\r\n\t\treturn data;\r\n\t},\r\n\r\n\tshowMessages: function(messages) {\r\n\t\tconst element = this.getElement('message', this.$el, 'siblings');\r\n\t\tconst rowTemplate = this.getTemplate('messageRow');\r\n\t\tlet html = '';\r\n\r\n\t\tfor (let message of messages) {\r\n\t\t\thtml += utils.compileTemplate(rowTemplate, {\r\n\t\t\t\t'TEXT': message.text,\r\n\t\t\t\t'STATUS': message.status\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\telement.attr('data-status', '');\r\n\t\telement.html(html);\r\n\t},\r\n\r\n\tshowMessage: function(message, status) {\r\n\t\tconst element = this.getElement('message', this.$el, 'siblings');\r\n\r\n\t\telement.attr('data-status', status);\r\n\t\telement.html(message || '');\r\n\t},\r\n\r\n\tgetFormData: function() {\r\n\t\treturn this.getOrderElement().find('input, select, textarea').serializeArray();\r\n\t},\r\n\r\n\tgetOrderElement: function() {\r\n\t\treturn this.getElement('order', this.$el, 'closest');\r\n\t},\r\n\r\n\tgetOrder: function() {\r\n\t\tconst node = this.getOrderElement();\r\n\r\n\t\treturn Plugin.manager.getInstance(node);\r\n\t},\r\n\r\n}, {\r\n\tdataName: 'orderViewShipmentSubmit',\r\n\tpluginName: 'YandexMarket.OrderView.ShipmentSubmit',\r\n});\r\n\r\nexport const ShipmentSubmit = constructor;\r\n"],"names":["BX","window","$","jQuery","constructor","namespace","Complex","extend","defaults","childElement","inputElement","areaElement","refreshUrl","initialize","callParent","bind","destroy","unbind","handleActivityEnd","dir","this","el","proxy","onActivityEnd","refresh","getId","input","getInput","val","confirm","boxCollection","getChildField","basketConfirm","validate","callChildList","commit","hasChanges","boxIndex","callItemList","box","getBasket","ajax","url","options","then","updateArea","hideLoading","html","contents","newAreas","getElement","newMap","mapAreas","existsAreas","existsMap","type","hasOwnProperty","newArea","replaceWith","onCustomEvent","target","areas","result","index","length","area","eq","data","closeWait","dataName","pluginName","Order","selfElement","titleElement","numberElement","deleteElement","langPrefix","lang","handleDeleteClick","onDeleteClick","evt","preventDefault","onlyForPart","getLang","getCollection","deleteItem","$el","basketItem","isPart","getTitle","title","text","replace","trim","setIndex","updateNumber","refreshDelete","enabled","prop","refreshNumber","getIndex","getParentField","key","context","method","keySelector","getElementSelector","selfSelector","nextUntil","Box","Reference","Plugin","Collection","itemElement","footerElement","getCountChanges","concat","getPreviousMovableBox","previous","item","getNextMovableBox","found","createNew","addItem","sameBasketItems","e","message","Error","source","isCopy","refreshBoxNumber","refreshBoxDelete","detachItem","itemSelector","footerSelector","siblings","join","add","cloneItem","sourceItem","clone","appendItem","next","nextAll","parent","manager","initializeContext","silent","transferBasket","getItemInstance","basket","getActiveItems","siblingBox","initializeItem","getOrder","getItemPlugin","BoxCollection","YandexMarket","Base","modalWidth","modalHeight","initVars","_modal","_openDeferred","handleModal","modal","handleModalSave","handleModalClose","onModalSave","onModalClose","resolve","destroyModal","Close","reject","open","SetContent","Show","afterOpen","Deferred","resolveValues","skipCreate","EditDialog","btnSave","btnCancel","modalContent","PARTS","CONTENT_DATA","BasketItemSkeletonModal","BasketItemMoveModal","count","countElement","boxElement","currentIndex","selectedIndex","content","renderCount","renderBox","select","boxes","getItemInstances","i","option","prependTo","find","resolvedBox","resolvedCount","selected","parseInt","getItem","BasketItemSplitModal","id","upElement","moreElement","downElement","splitElement","splitModalElement","moveModalElement","_moreDropdown","handleCountChange","handleUp","handleDown","handleMore","onCountChange","onUp","onDown","onMore","updateCisCount","getBox","moveStart","menu","moreDropdown","currentTarget","setItems","moreMenuItems","currentBox","selectedBox","getCount","newItem","move","recalculateOffset","refreshItemMove","resolved","moveCount","setCount","setInitialCount","getInitialCount","newBox","needClone","sameItems","insertItem","anchor","CMenu","ATTACH_MODE","SET_ID","CLOSE_ON_CLICK","values","getValue","moreMenuItemsForSplit","moreMenuItemsForDelete","push","ONCLICK","markDeleted","TEXT","cancelSplit","splitStart","deleted","toggleClass","parts","initialCount","countSiblings","first","part","previousBox","resetPart","setOffset","basketItems","isFinalPart","total","split","deletedCount","deletedInitialCount","removeSiblings","lastItem","productIndex","isSelf","setPart","sameItem","currentInput","totalInput","nameElement","removeClass","addClass","refreshMoveUp","canMoveUp","refreshMoveDown","canMoveDown","offset","getOffset","isValid","fields","getCis","getDigital","field","setBasketCount","refreshSummary","currentValue","totalValue","boxIndexInput","changed","name","getCountDiff","needDelete","countInput","initialInput","BasketItem","detach","appendTo","targetId","nextBox","hasPrevious","hasNext","hasFewItems","activeCount","diff","Basket","copyElement","rowElement","copy","handleCopyClick","onCopyClick","copyValues","getCopyValue","Object","assign","setValue","rows","row","BasketItemCis","Summary","summaryElement","fieldElement","modalElement","requiredTypes","optionalTypes","handleSummaryClick","onSummaryClick","openEditModal","updateField","syncSameBasketItems","ourBasketItem","getBasketItem","fieldName","value","siblingBasketItem","siblingCis","valueList","getCisStatus","status","statusText","summary","attr","filled","optional","getFilledCount","types","itemFilled","itemOptional","indexOf","getBasketCount","callField","getFieldPlugin","createModal","BasketItemCisSummary","BasketItemDigital","modalBaseHeight","modalOneHeight","_basketCount","resolveModalHeight","raw","parseValue","getDigitalStatus","keyChain","valueKeyChain","setValueByKeyChain","chain","lastKey","pop","level","nextKey","test","Array","isArray","BasketItemDigitalSummary","BasketConfirmForm","productsElement","allowRemove","allow","setItemsChanges","changes","element","compileItemsChanges","change","NAME","COUNT","_confirmDeferred","onEditModalSave","resolveConfirm","onEditModalClose","rejectConfirm","initEdit","waitConfirm","deferred","replaces","BasketConfirmSummary","width","height","items","handleClick","handleShipmentSubmit","onClick","isDisabled","onShipmentSubmitEnd","enable","createDropdown","hasClass","getDropdownItems","adminShowMenu","itemIndex","TITLE","ACTION","openDialog","TYPE","buildUrl","createDialog","PrintDialog","DIALOG_TITLE","content_url","WIDTH","HEIGHT","buttons","ShipmentPrint","utils","messageElement","messageRowTemplate","orderElement","_handleBoxCollectionChange","handleShipmentChange","handleBoxCollectionChange","getOrderElement","onOrderChange","onBoxCollectionModify","clear","instance","contains","showMessage","activate","disabled","when","query","activateEnd","activateStop","xhr","reason","messages","showMessages","confirmMessage","MESSAGE","getQueryData","dataType","getFormData","bitrix_sessid","rowTemplate","getTemplate","compileTemplate","serializeArray","node","getInstance","ShipmentSubmit"],"mappings":"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"}